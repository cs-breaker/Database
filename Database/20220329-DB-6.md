# 20220329 6차 DB 스터디

일시 : 2022 - 03 - 29 (화)

장소 : 비대면 화상 회의

질문자 : 김대희

답변자 : A) 김가영, B) 전종민


범위 : [데이터베이스 개론 3판: 김연희 저] ch10. 회복과 병행 제어, ch11. 보안과 권한관리

---

## Q1. 트랜잭션이란 무엇이고, 왜 필요한지 설명하시오

- A) 트랜잭션이란 하나의 작업을 수행하기 위해 필요한 데이터베이스의 연산 집합을 의미합니다.
트랜잭션이 필요한 이유는 Insert, delete, update등의 데이터 변경문의 실행을 트랜잭션을 통해 관리 할 수 있으며 이를 통해 데이터베이스의 무결성과 일관성을 보장할 수 있기 때문입니다.

- B) 트랜잭션이란 데이터베이스의 논리적인 작업의 단위. DBMS가 DB를 항상 정확하고 일관된 상태를 유지할 수 있도록 제공하는 기능 중 하나. 트랜잭션을 관리함으로써 DB의 회복과 병행 제어가 가능해져 일관성 유지가 됨.


## Q2. 트랜잭션의 성질에 대해 말해보시오

- A) 트랜잭션은 원자성, 일관성, 격리성, 지속성의 네 가지 성질을 가지고 있습니다.
원자성은 트랜잭션을 구성하는 연산은 모두 정상적으로 실행되거나 하나도 실행되지 않아야 한다는 것이고,
일관성은 트랜잭션이 성공적으로 수행된 후에도 데이터베이스가 일관된 상태를 유지해야 하는 것이며,
격리성은 수행 중인 트랜잭션이 완료될 때까지 트랜잭션이 생성한 중간 연산 결과에 다른 트랜잭션이 접근할 수 없다는 것이고,
영구성은 트랜잭션이 성공적으로 완료된 후 데이터베이스에 반영한 수행 결과는 어떠한 경우에도 손실되지 않고 영구적이어야 한다는 것입니다.

- B) 트랜잭션에는 네 가지 성질이 있음. ACID라고 하고, 각각 원자성, 일관성, 격리성, 지속성을 의미.
원자성은 트랜잭션은 구성하는 연산들이 모두 정상적으로 실행되거나 하나도 실행되지 않아야 한다는 것을 의미. 일관성은 트랜잭션이 성공적으로 수행된 후에도 데이터베이스가 일관된 상태를 유지해야한다는 의미. 격리성은 현재 수행 중인 트랜잭션이 완료될 때까지 트랜잭션이 생성한 중간 연산 결과에 다른 트랜잭션들이 접근할 수 없음을 의미. 지속성은 트랜잭션이 성공적으로 완료된 후 데이터베이스에 반영한 수행 결과는 어떠한 경우에도 손실되지 않고 영구적이어야 함을 의미.

## Q3. 트랜잭션이 병행 수행될 시 발생할 수 있는 문제점을 설명하시오

- A) 트랜잭션이 병행 수행될 때 나타날 수 있는 문제점에는
갱신 분실 : 하나의 트랜잭션이 수행한 데이터 변경 연산의 결과를 다른 트랜잭션이 덮어서 변경 연산이 무효되는 것
모순성 : 하나의 트랜잭션이 여러 개의 데이터 변경 연산을 실행할 때, 일관성 없는 상태의 데이터베이스에서 데이터를 가져와 연산 실행 시 모순된 결과가 발생하는 것
연쇄 복귀 : 트랜잭션이 완료되기 전에 장애가 발생해 rollback연산을 수행하면, 이 트랜잭션이 장애발생 전에 변경한 데이터를 가져가 변경 연산을 실행한 다른 트랜잭션에도 rollback연산을 실행해야 한다는 것.

- B) 첫 번째, 하나의 트랜잭션이 수행한 데이터 변경 연산의 결과를 다른 트랜잭션이 덮어써 변경 연산이 무효화될 수 있다. 두 번째, 하나의 트랜잭션이 여러 개의 데이터 변경 연산을 실행할 때 일관성 없는 상태의 데이터베이스에서 데이터를 가져와 연산을 실행함으로써 모순된 결과가 발생할 수 있다. 세 번째, 트랜잭션이 완료되기 전에 장애가 발생하여 rollback 연산을 수행하면, 이 트랜잭션이 장애 발생 전에 변경한 데이터를 가져가 변경 연산을 실행한 또 다른 트랜잭션에도 rollback 연산을 연쇄적으로 실행해야 한다. 그런데 장애가 발생한 트랜잭션이 rollback 연산을 실행하기 전에, 변경한 데이터를 가져가 사용하는 다른 트랜잭션이 수행을 완료해버리면 rollback 연산을 실행할 수 없어 문제가 발생하게 된다.

## Q4. 트랜잭션이 병행으로 처리될 때 발생할 수 있는 문제들을 방지하기 위한 방법을 설명하시오

- A) 갱신분실, 모순성, 연쇄 복귀 등은 트랜잭션이 비직렬적으로 처리될 때 발생하는 문제이므로, 트랜잭션에 포함되어 있는 연산들을 수행하는 순서인 트랜잭션 스케줄을 직렬 스케줄에 따라, 즉 순차적으로 수행되도록 조절함으로써 해당 문제들을 방지할 수 있습니다.
직렬 스케줄에 따라 수행된 트랜잭션은 다른 트랜잭션의 방해를 받지 않고 독립적으로 수행되므로 정확한 결과를 생성할 수 있습니다.

- B) 트랜잭션에 있는 연산은 실행하는 순서에 따라 트랜잭션의 수행 결과가 달라질 수 있으므로 트랜잭션 스케줄링을 할 때에 직렬 가능성을 보장하는 병행 제어 기법을 사용해 앞선 문제들을 방지할 수 있다. 병행 수행되는 트랜잭션들이 동일한 데이터에 접근하지 못하도록 lock과 unlock 연산을 이용해 제어할 수 있다. 한 트랜잭션이 먼저 접근한 데이터에 대한 연산을 모두 마칠 때까지, 해당 데이터에 다른 트랜잭션이 접근하지 못하도록 상호 배제하여 직렬 가능성을 보장한다. 하지만 너무 엄격한 제약으로 인해 하나의 트랜잭션이 모든 데이터에 대한 독점권을 갖게 된다. 데이터를 단순히 읽어오기만 하는 read 연산의 경우, 다른 트랜잭션이 같은 데이터에 동시에 read 연산을 수행해도 문제가 없으므로, read 연산을 동시에 실행할 수 있도록 처리 효율성을 높이는 방법을 고려할 수 있다. 2단계 로킹 규약은 트랜잭션이 lock과 unlock 연산을 확장, 축소 단계로 나누어 실행해야 한다는 규약이다. 2단계 로킹 규약을 준수하는 트랜잭션은 직렬 가능성이 보장된다. 하지만 여전히 데드락이 발생할 수 있다. 데드락은 처음부터 발생하지 않도록 예방하거나, 발생했을 때 빨리 탐지하여 필요한 조치를 취하는 방법으로 해결한다.

## Q5. 2단계 로킹 규약을 준수하면 직렬 가능성이 보장되는데, 2단계 로킹 규약을 준수하면 왜 직렬 가능성이 보장되는지 설명하시오.

- A) 2단계 로킹 규약이란 확장, 축소 단계로 나누어져 있는데 확장 단계에서는 트랜잭션이 독점권을 가진 연산만 실행할 수 있고, 축소 단계에서는 트랜잭션이 독점권을 반납한 연산만 실행할 수 있다. 각 트랜잭션이 lock, unlock하는 시점이 제한되어 있으므로 두개의 트랜잭션이 한 데이터를 가지고 동시에 연산할 수 없기 때문에 직렬 가능성이 보장됩니다.

- B) 데이터를 갖고 있던 트랜잭션이 너무 빨리 unlock 연산을 수행하게 되면 다른 트랜잭션이 일관성 없는 데이터에 접근하게 되어 문제가 발생한다. 2단계 로킹 규약은 모든 트랜잭션이 확장, 축소 단계를 거치므로 unlock이 빨리 발생해 일관성 없는 데이터를 거치지 않게 된다.

## Q6. 2단계 로킹을 준수하지 않으면 직렬 가능하지 않은가?

- A) 그건 아니다.

- B) 기본 로킹만으로 트랜잭션 스케줄의 직렬 가능성을 완벽하게 보장할 수는 없다.

## Q7. 로킹 단위가 있는데, 로킹 단위에 따라 어떤게 구현이 용이하고 간단한지, 어떤게 병행성을 높일 수 있는지 설명하시오.

- A) locking 단위가 높을 수록 병행성은 낮아지고, 제어 난이도는 낮아진다.
예를 들어 전체 데이터에 로킹하는 경우 제어는 간단하지만 병행성 수행이라 할 수 없다.
Locking 그러나 작은 단위의 데이터인 속성에 로킹 연산을 하는 경우는 많은 트렌잭션이 병행 수행을 할 수 있어 병행성은 높아지지만, 제어가 복잡하다.

- B) lock 연산은 크게는 데이터베이스 전체, 작게는 데이터베이스를 구성하는 속성에 이르기까지 다양한 크기의 데이터를 대상으로 실행할 수 있다. 로킹 단위가 커질수록 병행성은 낮아지지만 제어가 쉽고, 로킹 단위가 작아질수록 제어가 어렵지만 병행성은 높아진다.

## Q8. 데이터베이스 장애 유형을 설명하시오

- A) 데이터 베이스의 장애는 크게 트랜잭션 장애, 시스템 장애, 미디어 장애로 구분할 수 있습니다.
트랜잭션 장애란 논리적 오류, 잘못된 데이터, 시스템 과다 사용 등에서 발생된  트랜잭션 수행 중 오류,
시스템 장애란 하드웨어 이상으로 메인메모리 정보에 대한 손상 등으로 시스템 수행을 계속할 수 없는 경우,
미디어 장애란 디스크 헤드의 손상등과 같은 이유로 디스크에 저장된 데이터베이스가 손상된 경우등을 의미합니다.


- B) 트랜잭션의 논리적 오류, 잘못된 데이터 입력, 시스템 자원의 과다 사용 요구 등으로 인해 발생하는 트랜잭션 장애. 하드웨어 이상으로 메인 메모리에 저장된 정보가 손실되거나 교착 상태가 발생한 경우 발생하는 시스템 장애. 디스크 헤드의 손상이나 고장 등으로 인해 발생하는 미디어 장애가 있습니다.

## Q9. 데이터베이스 회복 기법에 대해 설명하시오

- A : 데이터 베이스 회복 기법은 간단히 말해 '복사본을 만드는 방식'으로 구성됩니다.
크게 덤프 기법과 로그 기법으로 나뉘는데, 덤프 기법이란 데이터베이스 전체를 다른 비휘발성 저장 장치에 주기적으로 복사하는 방법으로, 미디어 회복 기법에 주로 사용되며 데이터베이스 전체 복사 가능하다는 장점이 있으나 높은 비용이 들고 CPU가 낭비된다는 단점이 있습니다. 로그 기법이란 데이터베이스에서 변경 연산이 실행될 때 마다 변경 이전, 이후값을 별도의 파일에 기록하는 방법으로, 덤프 기법의 단점을 해결할 수 있지만 과도한 redo연산으로 시간적 비효율성이 있을 수 있습니다. 데이터 전반적 손상을 회복할 때 사용하는 Redo, 변경중인 데이터나 데이터 중 변경된 내용만 신뢰성을 잃은 경우에 사용되는 undo연산의 실행으로 이루어집니다. 로그를 이용한 회복 기법에는 트랜잭션 수행 중 변경 연산에 따른 결과가 데이터베이스에 반영되는 시간에 따라 분류하는 즉시갱신, 지연갱신, 검사 시점을 이용해 로그를 이용해 전체 데이터를 회복하는 기법의 시간적 비효율성을 해결하기 위한 기법인 검사 시점 회복기법 등으로 나뉩니다.

- B) 데이터베이스 회복의 핵심 원리는 데이터 중복이다. 데이터를 별도의 장소에 미리 복사해두고, 장애로 문제가 발생했을 때 복사본을 이용해 원래의 상태로 복원하는 것이다. 데이터베이스 전체를 다른 저장 장치에 주기적으로 복사하는 덤프 기법과 데이터베이스에서 변경 연산이 실행될 때마다 데이터를 변경하기 이전 값과 변경한 이후의 값을 별도의 파일에 기록하는 로그 기법을 활용한다. 즉시 갱신 회복 기법, 트랜잭션 수행 중에 데이터를 변경한 연산의 결과를 데이터베이스에 즉시 반영하고, 장애 발생에 대비하기 위해 데이터 변경에 대한 내용을 로그 파일에도 기록한다. 장애가 발생하면 로그 파일에 기록된 내용을 참조하여 장애 발생 시점에 따라 redo나 undo 연산을 실행하여 데이터베이스를 복구한다. 지연 갱신 회복 기법, 트랜잭션이 수행되는 동안에는 데이터 변경 연산의 결과를 데이터베이스에 즉시 반영하지 않고 로그 파일에만 기록해두었다가, 트랜잭션이 부분 완료된 후에 로그에 기록된 내용을 이용해 데이터베이스에 한 번에 반영한다. 트랜잭션이 수행되는 동안 장애가 발생할 경우 로그에 기록된 내용을 버리기만 하면 데이터베이스가 원래 상태를 그대로 유지하게 된다. 로그를 이용한 회복 기법은 로그 전체를 분석하여 로그에 기록된 모든 트랜잭션을 대상으로  redo나 undo를 적용한다. 그런데 이런 방식은 회복에 너무 많은 시간이 걸리고 redo 연산을 수행할 필요가 없는 트랜잭션에도 redo 연산을 실행하는 일이 발생하기도 한다. 검사 시점 회복 기법은 로그 기록을 이용하되, 일정 시간 간격으로 검사 시점을 만들어두고, 장애가 발생하면 가장 최근 검사 시점 이전의 트랜잭션에는 회복 작업을 수행하지 않고, 이후의 트랜잭션에만 회복 작업을 수행한다. 미디어 회복 기법은 전체 데이터베이스의 내용을 일정 주기마다 다른 안전한 저장 장치에 복사해두는 덤프를 이용해 디스크 장애가 발생하면 가장 최근에 복사해둔 덤프를 이용해 장애 발생 이전의 일관된 데이터베이스 상태로 복구한다.

## Q10. 데이터베이스 보안과 권한 관리에 대해 간단하게 설명하시오

- A) 데이터 베이스는 허가받은, 즉 권한이 있는 사용자만 데이터 베이스에 접근할 수 있도록 통제하는 방식으로 보안을 유지한다. 데이터베이스의 모든 객체의 권한은 데이터베이스 소유자에게 있는데, 객체 소유자는 필요에 따라 타 사용자에게 객체에 대한 사용 권한을 부여할 수 있다. 데이터 베이스 관리자는 객체에 대한 권한을 부여할 수는 없지만 시스템 권한을 부여할 수는 있다. GRANT를 통해 객체에 대한 역할이나 권한을 줄 수 있으며, REVOKE나 DROP ROLE을 통해 권한과 역할을 제거할 수 있다.

- B) 보안은 물리적 환경에 대한 보안, 권한 관리를 통한 보안, 운영 관리를 통한 보안으로 나뉜다. 권한 관리를 이용한 보안은 권한이 없는 사용자로부터 데이터베이스를 보호하는 것이고, 운영 관리를 통한 보안은 무결성 유지를 위해 권한이 있는 사용자로부터 데이터베이스를 보호하는 것이다.